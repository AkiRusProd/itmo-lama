# BNP Paribas Cardif Claims Management: AutoML vs Custom Pipeline

![Python](https://img.shields.io/badge/Python-3.10-blue)
![Jupyter](https://img.shields.io/badge/Jupyter-Notebook-orange)
![LightAutoML](https://img.shields.io/badge/AutoML-LightAutoML-green)
![Status](https://img.shields.io/badge/Status-Completed-success)

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ —Ä–∞–º–∫–∞—Ö —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è [BNP Paribas Cardif Claims Management](https://www.kaggle.com/competitions/bnp-paribas-cardif-claims-management).

**–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞:** –í —Ä–∞–º–∫–∞—Ö —É—á–µ–±–Ω–æ–≥–æ –∫—É—Ä—Å–∞ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ **LightAutoML (LAMA)**, –∞ –∑–∞—Ç–µ–º –ø—Ä–µ–≤–∑–æ–π—Ç–∏ –µ—ë —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ø–æ—Å—Ç—Ä–æ–∏–≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω —Å —É–≥–ª—É–±–ª–µ–Ω–Ω—ã–º Feature Engineering'–æ–º.

## –†–µ—à–µ–Ω–∏–µ
–†–µ—à–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ [automl.ipynb](automl.ipynb) 

## üìä –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

*   **–¢–∏–ø –∑–∞–¥–∞—á–∏:** –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è.
*   **–ú–µ—Ç—Ä–∏–∫–∞:** LogLoss (—á–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –ª—É—á—à–µ).
*   **–î–∞–Ω–Ω—ã–µ:** –ê–Ω–æ–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤—ã—Å–æ–∫–æ–π –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

## üõ†Ô∏è –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã (8 —Ä–µ—à–µ–Ω–∏–π)

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–±–∏—Ç –Ω–∞ 8 –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —à–∞–≥–æ–≤ ‚Äî –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±–µ–π–∑–ª–∞–π–Ω–∞ –¥–æ —Å–ª–æ–∂–Ω–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è.

### –ß–∞—Å—Ç—å 1: AutoML Baseline
1.  **`lama_baseline_general`**: –ó–∞–ø—É—Å–∫ LightAutoML —Å —Ç–∞–π–º-–ª–∏–º–∏—Ç–æ–º 3600 —Å–µ–∫. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ 2-—É—Ä–æ–≤–Ω–µ–≤—ã–π —Å—Ç–µ–∫–∏–Ω–≥.
2.  **`lama_baseline_specific`**: –û–±–ª–µ–≥—á–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è (600 —Å–µ–∫) —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ (LGBM + CatBoost).

### –ß–∞—Å—Ç—å 2: Custom Pipeline (Evolution)
3.  **`solution_v1` (Base XGBoost)**: –ü—Ä–æ—Å—Ç–æ–π –ø–∞–π–ø–ª–∞–π–Ω —Å Ordinal Encoding. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞.
4.  **`solution_v2` (Feature Engineering)**:
    *   –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∏–∑–Ω–∞–∫ `nan_count`.
    *   –ü—Ä–∏–º–µ–Ω–µ–Ω **Count Encoding** –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–∞ `v22`.
    *   *–†–µ–∑—É–ª—å—Ç–∞—Ç:* –†–µ–∑–∫–∏–π —Å–∫–∞—á–æ–∫ –∫–∞—á–µ—Å—Ç–≤–∞, —É–≤–µ—Ä–µ–Ω–Ω—ã–π –æ–±—Ö–æ–¥ AutoML.
5.  **`solution_v2_1` (Interactions)**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–∞—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —á–µ—Ä–µ–∑ *Mutual Information*. –î–æ–±–∞–≤–ª–µ–Ω—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –≤–∏–¥–∞ `v22_featureX`.
6.  **`solution_v2_2` (Tuning)**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ XGBoost —Å –ø–æ–º–æ—â—å—é **Optuna** (Bayesian Optimization).
7.  **`solution_v3` (Diversity)**: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ **ExtraTreesClassifier** (Bagging). –ú–æ–¥–µ–ª—å –∏–º–µ–µ—Ç –¥—Ä—É–≥—É—é –ø—Ä–∏—Ä–æ–¥—É –æ—à–∏–±–æ–∫ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –±—É—Å—Ç–∏–Ω–≥–æ–º.
8.  **`solution_v3_1` (Blending)**: –§–∏–Ω–∞–ª—å–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å (XGBoost + ExtraTrees). –í–µ—Å–∞ –ø–æ–¥–æ–±—Ä–∞–Ω—ã —á–µ—Ä–µ–∑ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—é LogLoss –º–µ—Ç–æ–¥–æ–º `scipy.optimize`.

## üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (Blending) –ø—Ä–µ–≤–∑–æ—à–ª–æ –ª—É—á—à–∏–π –±–µ–π–∑–ª–∞–π–Ω AutoML –±–æ–ª–µ–µ —á–µ–º –Ω–∞ **0.02 LogLoss**, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º –æ—Ç—Ä—ã–≤–æ–º.

| –†–µ—à–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | CV Score (OOF) | Private LB Score | Public LB Score | –°—Ç–∞—Ç—É—Å |
|:---|:---|:---:|:---:|:---:|:---:|
| **Solution v3.1** | **Blending (XGB + ExtraTrees)** | **0.45493** | **0.45249** | **0.45411** | üèÜ **Best** |
| Solution v3 | ExtraTrees Classifier | 0.45786 | 0.45451 | 0.45612 | |
| Solution v2.2 | XGBoost Tuned (Optuna) | 0.45984 | 0.45666 | 0.45819 | |
| Solution v2.1 | XGBoost + Interactions | 0.46144 | 0.45847 | 0.46025 | |
| Solution v2 | XGBoost + Count Enc | 0.46245 | 0.45913 | 0.46046 | ‚úÖ Beat LAMA |
| **LAMA General** | **AutoML Baseline (Heavy)** | **0.47526** | **0.47326** | **0.47469** | *Baseline* |
| Solution v1 | XGBoost Base | 0.47804 | 0.47398 | 0.47628 | |
| LAMA Fast | AutoML (Light) | 0.47914 | 0.47600 | 0.47818 | |

### –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (Kaggle LB)
–ü–æ—Ä—è–¥–æ–∫ –º–æ–¥–µ–ª–µ–π –Ω–∞ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π.

![Leaderboard](images/report.png)
